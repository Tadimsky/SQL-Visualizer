
var compiledGrammar = {"table":[[0,"source",1],[0,"start",2],[0,"sql_stmt_list",3],[7,4],[4,5,6,5,7],[0,"whitespace",8],[8,9],[0,"semicolon",10],[6,11],[0,"sql_stmt",12],[5,";"],[2,"[ \\t\\n\\r]"],[4,13,14],[8,15],[3,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42],[4,43,44],[0,"alter_table_stmt",45],[0,"analyze_stmt",46],[0,"attach_stmt",47],[0,"begin_stmt",48],[0,"commit_stmt",49],[0,"create_index_stmt",50],[0,"create_table_stmt",51],[0,"create_trigger_stmt",52],[0,"create_view_stmt",53],[0,"create_virtual_table_stmt",54],[0,"delete_stmt",55],[0,"delete_stmt_limited",56],[0,"detach_stmt",57],[0,"drop_index_stmt",58],[0,"drop_table_stmt",59],[0,"drop_trigger_stmt",60],[0,"drop_view_stmt",61],[0,"insert_stmt",62],[0,"pragma_stmt",63],[0,"reindex_stmt",64],[0,"release_stmt",65],[0,"rollback_stmt",66],[0,"savepoint_stmt",67],[0,"select_stmt",68],[0,"update_stmt",69],[0,"update_stmt_limited",70],[0,"vacuum_stmt",71],[0,"EXPLAIN",72],[8,73],[4,74,75,76],[4,77,78],[4,79,80,81,82,83],[4,84,85,86],[4,87,86],[4,88,89],[4,90,91],[4,92,93,94,95,96],[4,97,98],[4,99,100],[4,101,102,103,104],[4,101,102,103,104,105],[4,106,80,83],[4,107,108,109,110,111],[4,107,112,109,113],[4,107,114,109,110,115],[4,107,116,109,110,117],[4,118,119,113,120],[4,121,110,122,123],[4,124,125,126],[4,127,128,129],[4,130,86,131],[4,132,129],[4,133,134,135],[4,136,137],[4,136,137,105],[0,"VACUUM",138],[4,5,139],[4,140,141],[4,142,112,113],[4,143,144,145],[4,146,147,148],[0,"ANALYZE",149],[8,150],[0,"ATTACH",151],[8,152],[0,"expr",153],[0,"AS",154],[0,"database_name",155],[0,"BEGIN",156],[8,157],[8,158],[3,159,160],[4,161,162,108,163],[4,110,111,164,165,166,167,168],[4,161,169,112,163],[4,113,170,171],[4,161,169,114,163],[4,110,115,172],[4,173,164,165],[4,174,175],[4,84,176,160],[4,161,169,116,163],[4,110,117,82,39],[4,161,177,112,113],[4,178,179,180],[0,"DELETE",181],[0,"FROM",182],[0,"qualified_table_name",183],[8,184],[8,185],[0,"DETACH",186],[0,"DROP",187],[0,"INDEX",188],[8,189],[8,190],[0,"index_name",155],[0,"TABLE",191],[0,"table_ref",192],[0,"TRIGGER",193],[0,"trigger_name",155],[0,"VIEW",194],[0,"view_name",155],[3,195,196],[0,"INTO",197],[3,198,199],[0,"PRAGMA",200],[0,"pragma_name",155],[8,201],[0,"REINDEX",202],[0,"collation_name",155],[4,113,111],[0,"RELEASE",203],[8,132],[0,"savepoint_name",155],[0,"ROLLBACK",204],[8,205],[0,"SAVEPOINT",206],[4,207,208],[8,209],[8,210],[4,211,212,103],[4,213,214,104],[4,215,216],[5,"EXPLAIN"],[0,"QUERY",217],[0,"PLAN",218],[0,"ALTER",219],[0,"RENAME",220],[0,"TO",221],[0,"new_table_name",155],[0,"ADD",222],[8,223],[0,"column_def",224],[4,215,225],[3,83,226,227],[4,215,228],[0,"DATABASE",229],[4,5,230],[4,215,231],[0,"name",232],[4,215,233],[3,234,235,236],[0,"TRANSACTION",237],[0,"COMMIT",238],[0,"END",239],[0,"CREATE",240],[8,241],[8,242],[0,"ON",243],[0,"table_name",155],[0,"lparen",244],[7,245],[0,"rparen",246],[8,247],[4,166,248,249,168],[4,82,39],[8,250],[3,101,251,252],[8,253],[8,254],[7,255],[0,"VIRTUAL",256],[0,"USING",257],[0,"module_name",155],[8,258],[4,5,259],[4,215,260],[4,113,261],[4,262,81],[4,263,210],[4,215,264],[4,215,265],[4,215,266],[4,267,268],[4,83,269],[4,215,270],[4,110,165],[4,215,271],[4,215,272],[4,251,212],[0,"REPLACE",273],[4,215,274],[4,275,276],[4,277,278],[4,215,279],[3,280,281],[4,215,282],[4,215,283],[4,215,284],[4,144,128,129],[4,215,285],[0,"select_core",286],[6,287],[4,288,289,290,291],[4,292,81,293],[0,"UPDATE",294],[8,295],[0,"SET",296],[7,297],[0,"whitespace1",298],[5,"VACUUM"],[4,215,299],[4,215,300],[4,215,301],[4,215,302],[4,215,303],[4,215,304],[0,"COLUMN",305],[4,306,307,308],[5,"ANALYZE"],[0,"table_or_index_name",155],[4,83,269,226],[5,"ATTACH"],[4,215,309],[3,310,311,312,313,314,315,316,317],[5,"AS"],[7,318],[5,"BEGIN"],[0,"DEFERRED",319],[0,"IMMEDIATE",320],[0,"EXCLUSIVE",321],[4,215,322],[4,215,323],[4,215,324],[4,5,325],[0,"UNIQUE",326],[4,267,327,268],[4,215,328],[5,"("],[4,329,330],[5,")"],[3,331,332],[7,333],[7,334],[3,335,336,337],[0,"INSERT",338],[4,211,339],[4,340,341,342],[4,343,81],[4,344,7],[4,215,345],[4,215,346],[4,166,347,168],[5,"DELETE"],[5,"FROM"],[8,348],[0,"WHERE",349],[8,350],[5,"DETACH"],[5,"DROP"],[5,"INDEX"],[0,"IF",351],[0,"EXISTS",352],[0,"dot",353],[5,"TABLE"],[5,"TRIGGER"],[5,"VIEW"],[4,5,354],[5,"INTO"],[8,355],[3,356,39],[0,"DEFAULT",357],[0,"VALUES",358],[5,"PRAGMA"],[4,359,360],[4,166,360,168],[5,"REINDEX"],[5,"RELEASE"],[5,"ROLLBACK"],[5,"SAVEPOINT"],[4,361,362,363,364,104,365],[4,366,207],[0,"ORDER",367],[0,"BY",368],[0,"ordering_term",369],[6,370],[0,"LIMIT",371],[8,372],[4,5,373],[4,374,375],[4,215,376],[4,377,330],[7,11],[5,"QUERY"],[5,"PLAN"],[5,"ALTER"],[5,"RENAME"],[5,"TO"],[5,"ADD"],[4,215,378],[0,"column_name",155],[8,379],[7,380],[5,"DATABASE"],[4,317,381,81],[4,317,382,125],[4,317,383,384,81,385],[4,317,386],[4,317,387,383,81],[4,317,383,388,81,389,81],[4,317,383,390,391],[0,"value",392],[2,"[A-Za-z0-9_]"],[4,215,393],[4,215,394],[4,215,395],[5,"TRANSACTION"],[5,"COMMIT"],[5,"END"],[5,"CREATE"],[4,215,396],[0,"NOT",397],[5,"ON"],[0,"indexed_column",398],[0,"comma",399],[0,"TEMP",400],[0,"TEMPORARY",401],[4,148,330],[4,330,402],[0,"BEFORE",403],[0,"AFTER",404],[4,405,406],[4,5,407],[8,408],[0,"FOR",409],[0,"EACH",410],[0,"ROW",411],[0,"WHEN",412],[3,40,33,26,39],[5,"VIRTUAL"],[5,"USING"],[7,413],[3,414,415],[4,215,416],[4,288,289,417],[4,215,418],[4,215,419],[5,"."],[5,"REPLACE"],[4,166,420,168],[4,278,166,421,168],[4,215,422],[4,215,423],[0,"equal",424],[0,"pragma_value",425],[0,"SELECT",426],[8,427],[0,"select_results",428],[8,429],[8,430],[0,"compound_operator",431],[4,215,432],[4,215,433],[4,5,434],[4,5,330,290],[4,215,435],[4,436,81],[5,"UPDATE"],[0,"OR",437],[3,130,438,196,439,440],[5,"SET"],[4,306,359,81],[5,"COLUMN"],[0,"type_name",441],[0,"column_constraint",442],[0,"binary_operator",443],[0,"COLLATE",444],[8,327],[3,445,446,447,448],[8,449],[3,450,451,452],[0,"IS",453],[0,"BETWEEN",454],[0,"AND",455],[0,"IN",456],[3,457,113],[4,5,458],[5,"DEFERRED"],[5,"IMMEDIATE"],[5,"EXCLUSIVE"],[5,"UNIQUE"],[4,215,459],[4,306,460,461],[5,","],[4,215,462],[4,215,463],[0,"table_constraint",464],[4,215,465],[4,215,466],[0,"INSTEAD",467],[0,"OF",468],[5,"INSERT"],[4,406,469],[4,215,470],[4,215,471],[4,215,472],[4,215,473],[4,474,330],[4,475,289,111],[4,327,475],[5,"WHERE"],[7,476],[5,"IF"],[5,"EXISTS"],[4,306,477],[7,478],[5,"DEFAULT"],[5,"VALUES"],[5,"="],[3,479,155,480],[4,5,481],[3,482,483],[4,484,485],[4,102,486],[4,487,289,417,488],[3,489,490,491],[5,"ORDER"],[5,"BY"],[4,81,460,461],[5,"LIMIT"],[3,492,330],[4,215,493],[0,"ABORT",494],[0,"FAIL",495],[0,"IGNORE",496],[4,497,498],[4,499,500],[4,5,501],[4,215,502],[0,"LIKE",503],[0,"GLOB",504],[0,"REGEXP",505],[0,"MATCH",506],[4,507,81],[0,"ISNULL",508],[0,"NOTNULL",509],[4,327,510],[4,215,511],[4,215,512],[4,215,513],[4,215,514],[4,166,515,168],[3,516,517,518,306,519,520,521,522,523,524,525],[5,"NOT"],[8,526],[8,527],[5,"TEMP"],[5,"TEMPORARY"],[4,499,528],[5,"BEFORE"],[5,"AFTER"],[4,215,529],[4,215,530],[7,531],[5,"FOR"],[5,"EACH"],[5,"ROW"],[5,"WHEN"],[0,"module_argument",155],[0,"INDEXED",532],[4,290,330],[6,533],[4,81,330],[0,"signed_number",534],[0,"string_literal",535],[5,"SELECT"],[0,"DISTINCT",536],[0,"ALL",537],[0,"select_result",538],[6,539],[0,"join_source",540],[0,"GROUP",541],[8,542],[4,543,544],[0,"INTERSECT",545],[0,"EXCEPT",546],[0,"OFFSET",547],[5,"OR"],[4,215,548],[4,215,549],[4,215,550],[7,155],[8,551],[8,552],[3,553,554,555,556,557,526,558],[3,559,560,561,562,563,564,565,566,567,568,569,570,571,572,424,573,574,575,576,577,578,579,580,581,582,583,584],[5,"COLLATE"],[4,215,585],[4,215,586],[4,215,587],[4,215,588],[0,"ESCAPE",589],[4,215,590],[4,215,591],[0,"NULL",592],[5,"IS"],[5,"BETWEEN"],[5,"AND"],[5,"IN"],[8,593],[0,"literal_value",594],[0,"bind_parameter",595],[4,165,269,306],[4,596,81],[0,"call_function",597],[4,5,166,81,5,168],[4,598,166,81,82,379,168],[4,599,166,39,168],[4,600,601,602,603,160],[0,"raise_function",604],[4,382,125],[3,605,606],[3,607,556,608],[5,"INSTEAD"],[5,"OF"],[4,306,330],[4,215,609],[4,330,306],[4,610,611],[4,612,613,612],[4,215,614],[4,215,615],[4,5,616],[4,5,330,484],[4,5,617,618],[4,215,619],[4,620,81],[0,"UNION",621],[8,483],[4,215,622],[4,215,623],[4,215,624],[5,"ABORT"],[5,"FAIL"],[5,"IGNORE"],[3,625,626],[4,627,155],[4,628,629,461,630,631],[4,327,510,630],[4,241,630],[4,632,166,81,168],[4,277,633],[0,"foreign_key_clause",634],[5,"||"],[5,"*"],[5,"/"],[5,"%"],[5,"+"],[5,"-"],[5,"<<"],[5,">>"],[5,"&"],[5,"|"],[5,"<="],[5,">="],[5,"<"],[5,">"],[5,"=="],[5,"!="],[5,"<>"],[5,"IS"],[5,"IS NOT"],[5,"IN"],[5,"LIKE"],[5,"GLOB"],[5,"MATCH"],[5,"REGEXP"],[5,"AND"],[5,"OR"],[5,"LIKE"],[5,"GLOB"],[5,"REGEXP"],[5,"MATCH"],[4,215,635],[5,"ISNULL"],[5,"NOTNULL"],[4,215,636],[3,39,421],[3,611,480,637,510,638,639,640],[4,641,155],[0,"unary_operator",642],[4,643,5,166,644,5,168],[0,"CAST",645],[8,646],[0,"CASE",647],[8,81],[7,648],[8,649],[4,650,166,651,168],[0,"ASC",652],[0,"DESC",653],[4,654,166,167,168,630],[4,655,629,166,469,168,558],[5,"INDEXED"],[8,656],[0,"numeric_literal",657],[5,"\""],[6,658],[5,"DISTINCT"],[5,"ALL"],[3,659,660,661],[0,"single_source",662],[6,663],[5,"GROUP"],[0,"HAVING",664],[4,215,665],[5,"INTERSECT"],[5,"EXCEPT"],[5,"OFFSET"],[4,166,479,168],[4,166,479,330,479,168],[0,"CONSTRAINT",666],[0,"PRIMARY",667],[0,"KEY",668],[0,"conflict_clause",669],[8,670],[0,"CHECK",671],[3,479,516,672],[4,673,674,675],[5,"ESCAPE"],[5,"NULL"],[0,"blob_literal",480],[0,"CURRENT_TIME",676],[0,"CURRENT_DATE",676],[0,"CURRENT_TIMESTAMP",676],[5,"?"],[4,5,677],[0,"function_name",155],[8,678],[4,215,679],[4,383,268],[4,215,680],[4,343,81,681,81],[4,682,81],[0,"RAISE",683],[3,440,684],[4,215,685],[4,215,686],[3,687,241],[0,"FOREIGN",688],[3,689,690],[4,691,692],[3,693,694],[4,695,696],[4,165,269,661],[0,"star",560],[3,697,698,699,165,700,701,702],[4,703,5,617,704],[4,215,705],[5,"UNION"],[4,215,706],[4,215,707],[4,215,708],[8,709],[0,"AUTOINCREMENT",710],[4,215,711],[4,166,81,168],[4,712,713,714],[8,715],[8,716],[5,"now"],[3,564,563,717,718],[3,719,720],[5,"CAST"],[5,"CASE"],[0,"THEN",721],[0,"ELSE",722],[4,215,723],[4,724,330,725],[5,"ASC"],[5,"DESC"],[4,628,629],[4,215,726],[0,"plus",563],[0,"minus",564],[3,727,728],[8,729],[0,"escape_char",730],[2,"[^\"]"],[0,"column_ref",81],[8,731],[4,83,269,165,82,215,732],[4,83,269,165],[4,165,82,215,732],[4,733,734],[4,166,39,168,735],[4,166,486,168],[0,"join_op",736],[0,"join_constraint",737],[5,"HAVING"],[5,"CONSTRAINT"],[5,"PRIMARY"],[5,"KEY"],[4,164,738,739],[4,215,740],[5,"CHECK"],[0,"REFERENCES",741],[0,"foreign_table",155],[8,742],[7,743],[4,383,744,745],[5,"~"],[5,"NOT"],[4,746,747],[4,5,661],[4,215,748],[4,215,749],[5,"RAISE"],[3,130,438,439],[0,"error_message",480],[5,"FOREIGN"],[4,750,751],[4,752,750],[4,753,610,750],[4,754,755],[4,82,5,756],[0,"table_alias",155],[4,113,757],[8,758],[8,759],[3,760,761],[8,762],[0,"CONFLICT",763],[3,130,438,439,440,196],[5,"AUTOINCREMENT"],[4,215,764],[4,166,469,168],[3,765,766],[0,"DEFERRABLE",767],[8,768],[8,482],[7,769],[5,"THEN"],[5,"ELSE"],[7,770],[8,728],[0,"decimal_point",269],[0,"E",771],[5,"\\"],[1],[0,"column_alias",155],[8,772],[3,773,415],[4,82,5,732],[4,5,330],[4,774,775,776],[3,777,778],[4,215,779],[5,"REFERENCES"],[4,164,780,781],[4,448,155],[4,215,782],[3,783,784],[4,81,785],[0,"digit",786],[5,"E"],[4,82,215,732],[4,475,289,5,111],[8,787],[8,788],[0,"JOIN",789],[4,164,81],[4,178,5,166,790,5,168],[5,"CONFLICT"],[3,101,211],[3,791,792,793,794,795],[5,"DEFERRABLE"],[4,796,234],[4,796,235],[6,797],[2,"[0-9]"],[0,"NATURAL",798],[3,799,800,801],[4,215,802],[4,5,306,803],[4,213,510],[4,213,277],[0,"CASCADE",804],[0,"RESTRICT",805],[4,806,807],[0,"INITIALLY",808],[4,5,330,81],[4,215,809],[4,810,811],[0,"INNER",812],[0,"CROSS",813],[5,"JOIN"],[6,814],[4,215,815],[4,215,816],[0,"NO",817],[0,"ACTION",818],[4,215,819],[5,"NATURAL"],[0,"LEFT",820],[8,821],[4,215,822],[4,215,823],[4,5,330,5,306],[5,"CASCADE"],[5,"RESTRICT"],[4,215,824],[4,215,825],[5,"INITIALLY"],[4,215,826],[0,"OUTER",827],[5,"INNER"],[5,"CROSS"],[5,"NO"],[5,"ACTION"],[5,"LEFT"],[4,215,828],[5,"OUTER"],[0,"%start",830],[0,"%sql_stmt_list",831],[7,832],[4,833,834,833,835],[0,"%whitespace",8],[8,836],[0,"%semicolon",10],[0,"%sql_stmt",837],[4,838,839],[8,840],[3,841,842,843,844,845,846,847,848,849,850,851,852,853,854,855,856,857,858,859,860,861,862,863,864,865,866,867],[4,868,869],[0,"%alter_table_stmt",870],[0,"%analyze_stmt",871],[0,"%attach_stmt",872],[0,"%begin_stmt",873],[0,"%commit_stmt",874],[0,"%create_index_stmt",875],[0,"%create_table_stmt",876],[0,"%create_trigger_stmt",877],[0,"%create_view_stmt",878],[0,"%create_virtual_table_stmt",879],[0,"%delete_stmt",880],[0,"%delete_stmt_limited",881],[0,"%detach_stmt",882],[0,"%drop_index_stmt",883],[0,"%drop_table_stmt",884],[0,"%drop_trigger_stmt",885],[0,"%drop_view_stmt",886],[0,"%insert_stmt",887],[0,"%pragma_stmt",888],[0,"%reindex_stmt",889],[0,"%release_stmt",890],[0,"%rollback_stmt",891],[0,"%savepoint_stmt",892],[0,"%select_stmt",893],[0,"%update_stmt",894],[0,"%update_stmt_limited",895],[0,"%vacuum_stmt",896],[0,"%EXPLAIN",897],[8,898],[4,899,900,901],[4,902,903],[4,904,905,906,907,908],[4,909,910,911],[4,912,911],[4,913,914],[4,915,916],[4,917,918,919,920,921],[4,922,923],[4,924,925],[4,926,927,928,929],[4,926,927,928,929,930],[4,931,905,908],[4,932,933,934,935,936],[4,932,937,934,938],[4,932,939,934,935,940],[4,932,941,934,935,942],[4,943,944,938,945],[4,946,935,947,948],[4,949,950,951],[4,952,953,954],[4,955,911,956],[4,957,954],[4,958,959,960],[4,961,962],[4,961,962,930],[0,"%VACUUM",963],[4,833,139],[4,964,965],[4,966,937,938],[4,967,968,969],[4,970,971,972],[0,"%ANALYZE",973],[8,974],[0,"%ATTACH",975],[8,976],[0,"%expr",977],[0,"%AS",978],[0,"%database_name",979],[0,"%BEGIN",980],[8,981],[8,982],[3,983,984],[4,985,986,933,987],[4,935,936,988,989,990,991,992],[4,985,993,937,987],[4,938,994,995],[4,985,993,939,987],[4,935,940,996],[4,997,988,989],[4,998,999],[4,909,1000,984],[4,985,993,941,987],[4,935,942,907,864],[4,985,1001,937,938],[4,1002,1003,1004],[0,"%DELETE",1005],[0,"%FROM",1006],[0,"%qualified_table_name",1007],[8,1008],[8,1009],[0,"%DETACH",1010],[0,"%DROP",1011],[0,"%INDEX",1012],[8,1013],[8,1014],[0,"%index_name",979],[0,"%TABLE",1015],[0,"%table_ref",1016],[0,"%TRIGGER",1017],[0,"%trigger_name",979],[0,"%VIEW",1018],[0,"%view_name",979],[3,1019,1020],[0,"%INTO",1021],[3,1022,1023],[0,"%PRAGMA",1024],[0,"%pragma_name",979],[8,1025],[0,"%REINDEX",1026],[0,"%collation_name",979],[4,938,936],[0,"%RELEASE",1027],[8,957],[0,"%savepoint_name",979],[0,"%ROLLBACK",1028],[8,1029],[0,"%SAVEPOINT",1030],[4,1031,1032],[8,1033],[8,1034],[4,1035,1036,928],[4,1037,1038,929],[4,1039,216],[0,"%QUERY",1040],[0,"%PLAN",1041],[0,"%ALTER",1042],[0,"%RENAME",1043],[0,"%TO",1044],[0,"%new_table_name",979],[0,"%ADD",1045],[8,1046],[0,"%column_def",1047],[4,1039,225],[3,908,1048,1049],[4,1039,228],[0,"%DATABASE",1050],[4,833,1051],[4,1039,231],[0,"%name",232],[4,1039,233],[3,1052,1053,1054],[0,"%TRANSACTION",1055],[0,"%COMMIT",1056],[0,"%END",1057],[0,"%CREATE",1058],[8,1059],[8,1060],[0,"%ON",1061],[0,"%table_name",979],[0,"%lparen",244],[7,1062],[0,"%rparen",246],[8,1063],[4,990,1064,1065,992],[4,907,864],[8,1066],[3,926,1067,1068],[8,1069],[8,1070],[7,1071],[0,"%VIRTUAL",1072],[0,"%USING",1073],[0,"%module_name",979],[8,1074],[4,833,259],[4,1039,260],[4,938,1075],[4,1076,906],[4,1077,1034],[4,1039,264],[4,1039,265],[4,1039,266],[4,1078,1079],[4,908,1080],[4,1039,270],[4,935,989],[4,1039,271],[4,1039,272],[4,1067,1036],[0,"%REPLACE",1081],[4,1039,274],[4,1082,1083],[4,1084,1085],[4,1039,279],[3,1086,1087],[4,1039,282],[4,1039,283],[4,1039,284],[4,968,953,954],[4,1039,285],[0,"%select_core",1088],[6,1089],[4,1090,1091,1092,1093],[4,1094,906,1095],[0,"%UPDATE",1096],[8,1097],[0,"%SET",1098],[7,1099],[0,"%whitespace1",298],[4,1039,299],[4,1039,300],[4,1039,301],[4,1039,302],[4,1039,303],[4,1039,304],[0,"%COLUMN",1100],[4,1101,1102,1103],[0,"%table_or_index_name",979],[4,908,1080,1048],[4,1039,309],[3,1104,1105,1106,1107,1108,1109,1110,1111],[0,"%DEFERRED",1112],[0,"%IMMEDIATE",1113],[0,"%EXCLUSIVE",1114],[4,1039,322],[4,1039,323],[4,1039,324],[4,833,325],[0,"%UNIQUE",1115],[4,1078,1116,1079],[4,1039,328],[4,1117,1118],[3,1119,1120],[7,1121],[7,1122],[3,1123,1124,1125],[0,"%INSERT",1126],[4,1035,1127],[4,1128,1129,1130],[4,1131,906],[4,1132,835],[4,1039,345],[4,1039,346],[4,990,1133,992],[8,1134],[0,"%WHERE",1135],[8,1136],[0,"%IF",1137],[0,"%EXISTS",1138],[0,"%dot",353],[4,833,354],[8,1139],[3,1140,864],[0,"%DEFAULT",1141],[0,"%VALUES",1142],[4,1143,1144],[4,990,1144,992],[4,1145,1146,1147,1148,929,1149],[4,1150,1031],[0,"%ORDER",1151],[0,"%BY",1152],[0,"%ordering_term",1153],[6,1154],[0,"%LIMIT",1155],[8,1156],[4,833,373],[4,1157,1158],[4,1039,376],[4,1159,1118],[4,1039,378],[0,"%column_name",979],[8,1160],[7,1161],[4,1111,1162,906],[4,1111,1163,950],[4,1111,1164,1165,906,1166],[4,1111,1167],[4,1111,1168,1164,906],[4,1111,1164,1169,906,1170,906],[4,1111,1164,1171,1172],[0,"%value",1173],[4,1039,393],[4,1039,394],[4,1039,395],[4,1039,396],[0,"%NOT",1174],[0,"%indexed_column",1175],[0,"%comma",399],[0,"%TEMP",1176],[0,"%TEMPORARY",1177],[4,972,1118],[4,1118,1178],[0,"%BEFORE",1179],[0,"%AFTER",1180],[4,1181,1182],[4,833,407],[8,1183],[0,"%FOR",1184],[0,"%EACH",1185],[0,"%ROW",1186],[0,"%WHEN",1187],[3,865,858,851,864],[7,1188],[3,1189,1190],[4,1039,416],[4,1090,1091,1191],[4,1039,418],[4,1039,419],[4,990,1192,992],[4,1085,990,1193,992],[4,1039,422],[4,1039,423],[0,"%equal",424],[0,"%pragma_value",1194],[0,"%SELECT",1195],[8,1196],[0,"%select_results",1197],[8,1198],[8,1199],[0,"%compound_operator",1200],[4,1039,432],[4,1039,433],[4,833,1201],[4,833,1118,1092],[4,1039,435],[4,1202,906],[0,"%OR",1203],[3,955,1204,1020,1205,1206],[4,1101,1143,906],[0,"%type_name",1207],[0,"%column_constraint",1208],[0,"%binary_operator",1209],[0,"%COLLATE",1210],[8,1116],[3,1211,1212,1213,1214],[8,1215],[3,1216,1217,1218],[0,"%IS",1219],[0,"%BETWEEN",1220],[0,"%AND",1221],[0,"%IN",1222],[3,1223,938],[4,833,1224],[4,1039,459],[4,1101,1225,1226],[4,1039,462],[4,1039,463],[0,"%table_constraint",1227],[4,1039,465],[4,1039,466],[0,"%INSTEAD",1228],[0,"%OF",1229],[4,1182,1230],[4,1039,470],[4,1039,471],[4,1039,472],[4,1039,473],[4,1231,1118],[4,1232,1091,936],[4,1116,1232],[7,1233],[4,1101,1234],[7,1235],[3,1236,979,1237],[4,833,481],[3,1238,1239],[4,1240,1241],[4,927,1242],[4,1243,1091,1191,1244],[3,1245,1246,1247],[4,906,1225,1226],[3,1248,1118],[4,1039,493],[0,"%ABORT",1249],[0,"%FAIL",1250],[0,"%IGNORE",1251],[4,1252,1253],[4,1254,1255],[4,833,501],[4,1039,502],[0,"%LIKE",1256],[0,"%GLOB",1257],[0,"%REGEXP",1258],[0,"%MATCH",1259],[4,1260,906],[0,"%ISNULL",1261],[0,"%NOTNULL",1262],[4,1116,1263],[4,1039,511],[4,1039,512],[4,1039,513],[4,1039,514],[4,990,1264,992],[3,1265,1266,1267,1101,1268,1269,1270,1271,1272,1273,1274],[8,1275],[8,1276],[4,1254,1277],[4,1039,529],[4,1039,530],[7,1278],[0,"%module_argument",979],[0,"%INDEXED",1279],[4,1092,1118],[6,1280],[4,906,1118],[0,"%signed_number",1281],[0,"%string_literal",1282],[0,"%DISTINCT",1283],[0,"%ALL",1284],[0,"%select_result",1285],[6,1286],[0,"%join_source",1287],[0,"%GROUP",1288],[8,1289],[4,1290,1291],[0,"%INTERSECT",1292],[0,"%EXCEPT",1293],[0,"%OFFSET",1294],[4,1039,548],[4,1039,549],[4,1039,550],[7,979],[8,1295],[8,1296],[3,1297,1298,1299,1300,1301,1275,1302],[4,1039,585],[4,1039,586],[4,1039,587],[4,1039,588],[0,"%ESCAPE",1303],[4,1039,590],[4,1039,591],[0,"%NULL",1304],[8,1305],[0,"%literal_value",1306],[0,"%bind_parameter",1307],[4,989,1080,1101],[4,1308,906],[0,"%call_function",1309],[4,833,990,906,833,992],[4,1310,990,906,907,1160,992],[4,1311,990,864,992],[4,1312,1313,1314,1315,984],[0,"%raise_function",1316],[4,1163,950],[3,1317,1318],[3,1319,1300,1320],[4,1101,1118],[4,1039,609],[4,1118,1101],[4,1321,1322],[4,612,1323,612],[4,1039,614],[4,1039,615],[4,833,1324],[4,833,1118,1240],[4,833,1325,1326],[4,1039,619],[4,1327,906],[0,"%UNION",1328],[8,1239],[4,1039,622],[4,1039,623],[4,1039,624],[3,1329,1330],[4,1331,979],[4,1332,1333,1226,1334,1335],[4,1116,1263,1334],[4,1059,1334],[4,1336,990,906,992],[4,1084,1337],[0,"%foreign_key_clause",1338],[4,1039,635],[4,1039,636],[3,864,1193],[3,1322,1237,1339,1263,1340,1341,1342],[4,641,979],[0,"%unary_operator",1343],[4,1344,833,990,1345,833,992],[0,"%CAST",1346],[8,1347],[0,"%CASE",1348],[8,906],[7,1349],[8,1350],[4,1351,990,1352,992],[0,"%ASC",1353],[0,"%DESC",1354],[4,1355,990,991,992,1334],[4,1356,1333,990,1230,992,1302],[8,1357],[0,"%numeric_literal",1358],[6,1359],[3,1360,1361,1362],[0,"%single_source",1363],[6,1364],[0,"%HAVING",1365],[4,1039,665],[4,990,1236,992],[4,990,1236,1118,1236,992],[0,"%CONSTRAINT",1366],[0,"%PRIMARY",1367],[0,"%KEY",1368],[0,"%conflict_clause",1369],[8,1370],[0,"%CHECK",1371],[3,1236,1265,1372],[4,1373,1374,1375],[0,"%blob_literal",1237],[0,"%CURRENT_TIME",676],[0,"%CURRENT_DATE",676],[0,"%CURRENT_TIMESTAMP",676],[4,833,677],[0,"%function_name",979],[8,1376],[4,1039,679],[4,1164,1079],[4,1039,680],[4,1131,906,1377,906],[4,1378,906],[0,"%RAISE",1379],[3,1206,1380],[4,1039,685],[4,1039,686],[3,1381,1059],[0,"%FOREIGN",1382],[3,1383,1384],[4,1385,1386],[3,1387,694],[4,1388,1389],[4,989,1080,1362],[0,"%star",560],[3,1390,1391,1392,989,1393,1394,1395],[4,1396,833,1325,1397],[4,1039,705],[4,1039,706],[4,1039,707],[4,1039,708],[8,1398],[0,"%AUTOINCREMENT",1399],[4,1039,711],[4,990,906,992],[4,1400,1401,1402],[8,1403],[8,1404],[3,1405,1406],[0,"%THEN",1407],[0,"%ELSE",1408],[4,1039,723],[4,1409,1118,1410],[4,1332,1333],[4,1039,726],[0,"%plus",563],[0,"%minus",564],[3,1411,1412],[8,1413],[0,"%escape_char",730],[0,"%column_ref",906],[8,1414],[4,908,1080,989,907,1039,1415],[4,908,1080,989],[4,989,907,1039,1415],[4,1416,1417],[4,990,864,992,1418],[4,990,1242,992],[0,"%join_op",1419],[0,"%join_constraint",1420],[4,988,1421,1422],[4,1039,740],[0,"%REFERENCES",1423],[0,"%foreign_table",979],[8,1424],[7,1425],[4,1164,1426,1427],[4,1428,1429],[4,833,1362],[4,1039,748],[4,1039,749],[3,955,1204,1205],[0,"%error_message",1237],[4,1430,1431],[4,1432,1430],[4,1433,1321,1430],[4,907,833,1434],[0,"%table_alias",979],[4,938,1435],[8,1436],[8,1437],[3,1438,1439],[8,1440],[0,"%CONFLICT",1441],[3,955,1204,1205,1206,1020],[4,1039,764],[4,990,1230,992],[3,1442,1443],[0,"%DEFERRABLE",1444],[8,1445],[8,1238],[7,1446],[7,1447],[8,1412],[0,"%decimal_point",1080],[0,"%E",771],[0,"%column_alias",979],[8,1448],[3,1449,1190],[4,907,833,1415],[4,833,1118],[4,1450,1451,1452],[3,1453,1454],[4,1039,779],[4,988,1455,1456],[4,1214,979],[4,1039,782],[3,1457,1458],[4,906,1459],[0,"%digit",786],[4,907,1039,1415],[4,1232,1091,833,936],[8,1460],[8,1461],[0,"%JOIN",1462],[4,988,906],[4,1002,833,990,1463,833,992],[3,926,1035],[3,1464,1465,1466,1467,1468],[4,1469,1052],[4,1469,1053],[6,1470],[0,"%NATURAL",1471],[3,1472,1473,1474],[4,1039,802],[4,833,1101,1475],[4,1037,1263],[4,1037,1084],[0,"%CASCADE",1476],[0,"%RESTRICT",1477],[4,1478,1479],[0,"%INITIALLY",1480],[4,833,1118,906],[4,1039,809],[4,1481,1482],[0,"%INNER",1483],[0,"%CROSS",1484],[6,1485],[4,1039,815],[4,1039,816],[0,"%NO",1486],[0,"%ACTION",1487],[4,1039,819],[0,"%LEFT",1488],[8,1489],[4,1039,822],[4,1039,823],[4,833,1118,833,1101],[4,1039,824],[4,1039,825],[4,1039,826],[0,"%OUTER",1490],[4,1039,828]],"nameToUID":{"start":1,"sql_stmt_list":2,"whitespace":5,"semicolon":7,"sql_stmt":9,"alter_table_stmt":16,"analyze_stmt":17,"attach_stmt":18,"begin_stmt":19,"commit_stmt":20,"create_index_stmt":21,"create_table_stmt":22,"create_trigger_stmt":23,"create_view_stmt":24,"create_virtual_table_stmt":25,"delete_stmt":26,"delete_stmt_limited":27,"detach_stmt":28,"drop_index_stmt":29,"drop_table_stmt":30,"drop_trigger_stmt":31,"drop_view_stmt":32,"insert_stmt":33,"pragma_stmt":34,"reindex_stmt":35,"release_stmt":36,"rollback_stmt":37,"savepoint_stmt":38,"select_stmt":39,"update_stmt":40,"update_stmt_limited":41,"vacuum_stmt":42,"EXPLAIN":43,"VACUUM":71,"ANALYZE":77,"ATTACH":79,"expr":81,"AS":82,"database_name":83,"BEGIN":84,"DELETE":101,"FROM":102,"qualified_table_name":103,"DETACH":106,"DROP":107,"INDEX":108,"index_name":111,"TABLE":112,"table_ref":113,"TRIGGER":114,"trigger_name":115,"VIEW":116,"view_name":117,"INTO":119,"PRAGMA":121,"pragma_name":122,"REINDEX":124,"collation_name":125,"RELEASE":127,"savepoint_name":129,"ROLLBACK":130,"SAVEPOINT":132,"QUERY":140,"PLAN":141,"ALTER":142,"RENAME":143,"TO":144,"new_table_name":145,"ADD":146,"column_def":148,"DATABASE":152,"name":155,"TRANSACTION":158,"COMMIT":159,"END":160,"CREATE":161,"ON":164,"table_name":165,"lparen":166,"rparen":168,"VIRTUAL":177,"USING":178,"module_name":179,"REPLACE":196,"select_core":207,"UPDATE":211,"SET":213,"whitespace1":215,"COLUMN":223,"table_or_index_name":226,"DEFERRED":234,"IMMEDIATE":235,"EXCLUSIVE":236,"UNIQUE":241,"INSERT":251,"WHERE":262,"IF":267,"EXISTS":268,"dot":269,"DEFAULT":277,"VALUES":278,"ORDER":288,"BY":289,"ordering_term":290,"LIMIT":292,"column_name":306,"value":317,"NOT":327,"indexed_column":329,"comma":330,"TEMP":331,"TEMPORARY":332,"BEFORE":335,"AFTER":336,"FOR":340,"EACH":341,"ROW":342,"WHEN":343,"equal":359,"pragma_value":360,"SELECT":361,"select_results":363,"compound_operator":366,"OR":374,"type_name":379,"column_constraint":380,"binary_operator":381,"COLLATE":382,"IS":387,"BETWEEN":388,"AND":389,"IN":390,"table_constraint":402,"INSTEAD":405,"OF":406,"ABORT":438,"FAIL":439,"IGNORE":440,"LIKE":445,"GLOB":446,"REGEXP":447,"MATCH":448,"ISNULL":450,"NOTNULL":451,"module_argument":474,"INDEXED":475,"signed_number":479,"string_literal":480,"DISTINCT":482,"ALL":483,"select_result":484,"join_source":486,"GROUP":487,"INTERSECT":490,"EXCEPT":491,"OFFSET":492,"ESCAPE":507,"NULL":510,"literal_value":516,"bind_parameter":517,"call_function":520,"raise_function":525,"UNION":543,"foreign_key_clause":558,"unary_operator":596,"CAST":598,"CASE":600,"ASC":605,"DESC":606,"numeric_literal":611,"single_source":617,"HAVING":620,"CONSTRAINT":627,"PRIMARY":628,"KEY":629,"conflict_clause":630,"CHECK":632,"blob_literal":637,"CURRENT_TIME":638,"CURRENT_DATE":639,"CURRENT_TIMESTAMP":640,"function_name":643,"RAISE":650,"FOREIGN":655,"star":661,"AUTOINCREMENT":670,"THEN":681,"ELSE":682,"plus":689,"minus":690,"escape_char":693,"column_ref":695,"join_op":703,"join_constraint":704,"REFERENCES":712,"foreign_table":713,"error_message":725,"table_alias":732,"CONFLICT":738,"DEFERRABLE":744,"decimal_point":752,"E":753,"column_alias":756,"digit":770,"JOIN":776,"NATURAL":787,"CASCADE":793,"RESTRICT":794,"INITIALLY":796,"INNER":800,"CROSS":801,"NO":806,"ACTION":807,"LEFT":810,"OUTER":821,"%start":829,"%sql_stmt_list":830,"%whitespace":833,"%semicolon":835,"%sql_stmt":836,"%alter_table_stmt":841,"%analyze_stmt":842,"%attach_stmt":843,"%begin_stmt":844,"%commit_stmt":845,"%create_index_stmt":846,"%create_table_stmt":847,"%create_trigger_stmt":848,"%create_view_stmt":849,"%create_virtual_table_stmt":850,"%delete_stmt":851,"%delete_stmt_limited":852,"%detach_stmt":853,"%drop_index_stmt":854,"%drop_table_stmt":855,"%drop_trigger_stmt":856,"%drop_view_stmt":857,"%insert_stmt":858,"%pragma_stmt":859,"%reindex_stmt":860,"%release_stmt":861,"%rollback_stmt":862,"%savepoint_stmt":863,"%select_stmt":864,"%update_stmt":865,"%update_stmt_limited":866,"%vacuum_stmt":867,"%EXPLAIN":868,"%VACUUM":896,"%ANALYZE":902,"%ATTACH":904,"%expr":906,"%AS":907,"%database_name":908,"%BEGIN":909,"%DELETE":926,"%FROM":927,"%qualified_table_name":928,"%DETACH":931,"%DROP":932,"%INDEX":933,"%index_name":936,"%TABLE":937,"%table_ref":938,"%TRIGGER":939,"%trigger_name":940,"%VIEW":941,"%view_name":942,"%INTO":944,"%PRAGMA":946,"%pragma_name":947,"%REINDEX":949,"%collation_name":950,"%RELEASE":952,"%savepoint_name":954,"%ROLLBACK":955,"%SAVEPOINT":957,"%QUERY":964,"%PLAN":965,"%ALTER":966,"%RENAME":967,"%TO":968,"%new_table_name":969,"%ADD":970,"%column_def":972,"%DATABASE":976,"%name":979,"%TRANSACTION":982,"%COMMIT":983,"%END":984,"%CREATE":985,"%ON":988,"%table_name":989,"%lparen":990,"%rparen":992,"%VIRTUAL":1001,"%USING":1002,"%module_name":1003,"%REPLACE":1020,"%select_core":1031,"%UPDATE":1035,"%SET":1037,"%whitespace1":1039,"%COLUMN":1046,"%table_or_index_name":1048,"%DEFERRED":1052,"%IMMEDIATE":1053,"%EXCLUSIVE":1054,"%UNIQUE":1059,"%INSERT":1067,"%WHERE":1076,"%IF":1078,"%EXISTS":1079,"%dot":1080,"%DEFAULT":1084,"%VALUES":1085,"%ORDER":1090,"%BY":1091,"%ordering_term":1092,"%LIMIT":1094,"%column_name":1101,"%value":1111,"%NOT":1116,"%indexed_column":1117,"%comma":1118,"%TEMP":1119,"%TEMPORARY":1120,"%BEFORE":1123,"%AFTER":1124,"%FOR":1128,"%EACH":1129,"%ROW":1130,"%WHEN":1131,"%equal":1143,"%pragma_value":1144,"%SELECT":1145,"%select_results":1147,"%compound_operator":1150,"%OR":1157,"%type_name":1160,"%column_constraint":1161,"%binary_operator":1162,"%COLLATE":1163,"%IS":1168,"%BETWEEN":1169,"%AND":1170,"%IN":1171,"%table_constraint":1178,"%INSTEAD":1181,"%OF":1182,"%ABORT":1204,"%FAIL":1205,"%IGNORE":1206,"%LIKE":1211,"%GLOB":1212,"%REGEXP":1213,"%MATCH":1214,"%ISNULL":1216,"%NOTNULL":1217,"%module_argument":1231,"%INDEXED":1232,"%signed_number":1236,"%string_literal":1237,"%DISTINCT":1238,"%ALL":1239,"%select_result":1240,"%join_source":1242,"%GROUP":1243,"%INTERSECT":1246,"%EXCEPT":1247,"%OFFSET":1248,"%ESCAPE":1260,"%NULL":1263,"%literal_value":1265,"%bind_parameter":1266,"%call_function":1269,"%raise_function":1274,"%UNION":1290,"%foreign_key_clause":1302,"%unary_operator":1308,"%CAST":1310,"%CASE":1312,"%ASC":1317,"%DESC":1318,"%numeric_literal":1322,"%single_source":1325,"%HAVING":1327,"%CONSTRAINT":1331,"%PRIMARY":1332,"%KEY":1333,"%conflict_clause":1334,"%CHECK":1336,"%blob_literal":1339,"%CURRENT_TIME":1340,"%CURRENT_DATE":1341,"%CURRENT_TIMESTAMP":1342,"%function_name":1344,"%RAISE":1351,"%FOREIGN":1356,"%star":1362,"%AUTOINCREMENT":1370,"%THEN":1377,"%ELSE":1378,"%plus":1383,"%minus":1384,"%escape_char":1387,"%column_ref":1388,"%join_op":1396,"%join_constraint":1397,"%REFERENCES":1400,"%foreign_table":1401,"%error_message":1410,"%table_alias":1415,"%CONFLICT":1421,"%DEFERRABLE":1426,"%decimal_point":1432,"%E":1433,"%column_alias":1434,"%digit":1447,"%JOIN":1452,"%NATURAL":1460,"%CASCADE":1466,"%RESTRICT":1467,"%INITIALLY":1469,"%INNER":1473,"%CROSS":1474,"%NO":1478,"%ACTION":1479,"%LEFT":1481,"%OUTER":1489}};


function Parser(/*String | CompiledGrammar*/ aGrammar)
{
    if (typeof aGrammar.valueOf() === "string")
        this.compiledGrammar = new (require("./compiledgrammar"))(aGrammar);
    else
        this.compiledGrammar = aGrammar;

    return this;
}

module.exports = Parser;

Parser.prototype.parse = function(input)
{
    return parse(this.compiledGrammar, input);
}

var NAME                = 0,
    DOT                 = 1,
    CHARACTER_CLASS     = 2,
    ORDERED_CHOICE      = 3,
    SEQUENCE            = 4,
    STRING_LITERAL      = 5,
    ZERO_OR_MORE        = 6,
    ONE_OR_MORE         = 7,
    OPTIONAL            = 8,
    NEGATIVE_LOOK_AHEAD = 9,
    POSITIVE_LOOK_AHEAD = 10,
    ERROR_NAME          = 11,
    ERROR_CHOICE        = 12;

function parse(aCompiledGrammar, input, name)
{
    var node = new SyntaxNode("#document", input, 0, 0),
        table = aCompiledGrammar.table,
        nameToUID = aCompiledGrammar.nameToUID;

    name = name || "start";

    // This is a stupid check.
    if (aCompiledGrammar.nameToUID["EOF"] !== undefined)
        table[0] = [SEQUENCE, nameToUID[name], nameToUID["EOF"]];

    if (!evaluate(new context(input, table), node, table, 0))
    {
        // This is a stupid check.
        if (aCompiledGrammar.nameToUID["EOF"] !== undefined)
            table[0] = [SEQUENCE, nameToUID["%" + name], nameToUID["EOF"]];

        node.children.length = 0;

        evaluate(new context(input, table), node, table, 0);

        node.traverse(
        {
            traverseTextNodes:false,
            enteredNode:function(node)
            {
                if (node.error)
                    console.log(node.message() + "\n");
            }
        });
    }

    return node;
}

exports.parse = parse;

function context(input, table)
{
    this.position = 0;
    this.input = input;
    this.memos = [];
    for (var i=0;i<table.length;++i)
        this.memos[i] = [];
}

function evaluate(context, parent, rules, rule_id)
{
    var rule = rules[rule_id],
        type = rule[0],
        input_length = context.input.length,
        memos = context.memos[rule_id];

    var uid = context.position,
        entry = memos[uid];

    if (entry === false)
        return false;
    else if (entry === true)
        return true;
    else if (entry)
    {
        if (parent)
            parent.children.push(entry.node);
        context.position = entry.position;
        return true;
    }

    switch (type)
    {
        case NAME:
        case ERROR_NAME:
            var node = new SyntaxNode(rule[1], context.input, context.position, 0, rule[3]);
            if (!evaluate(context, node, rules, rule[2]))
            {
                memos[uid] = false;
                return false;
            }
            node.range.length = context.position - node.range.location;
            memos[uid] = { node:node, position:context.position };

            if (parent)
                parent.children.push(node);
            return true;

        case CHARACTER_CLASS:
            var character = context.input.charAt(context.position);

            if (typeof rule[1].valueOf() === "string")
                rule[1] = new RegExp(rule[1], "g");

            if (character.match(rule[1]))
            {
                if (parent)
                    parent.children.push(character);
                ++context.position;
                return true;
            }
            memos[uid] = false;
            return false;

        case SEQUENCE:
            var index = 1,
                count = rule.length;

            for (; index < count; ++index)
                if (!evaluate(context, parent, rules, rule[index]))
                {
                    memos[uid] = false;
                    return false;
                }

            return true;

        case ORDERED_CHOICE:
        case ERROR_CHOICE:
            var index = 1,
                count = rule.length,
                position = context.position;

            for (; index < count; ++index)
            {
                // cache opportunity here.
                var child_count = parent && parent.children.length;

                if (evaluate(context, parent, rules, rule[index]))
                    return true;

                if (parent)
                    parent.children.length = child_count;
                context.position = position;
            }
            memos[uid] = false;
            return false;

        case STRING_LITERAL:
            var string = rule[1],
                string_length = string.length;

            if (string_length + context.position > input_length)
            {
                memos[uid] = false;
                return false;
            }

            var index = 0;

            for (; index < string_length; ++context.position, ++index)
                if (context.input.charCodeAt(context.position) !== string.charCodeAt(index))
                {
                    context.position -= index;
                    memos[uid] = false;
                    return false;
                }

//            memos[uid] = string;
            if (parent)
                parent.children.push(string);

            return true;
        case DOT:
            if (context.position < input_length)
            {
                if (parent)
                    parent.children.push(context.input.charAt(context.position));
                ++context.position;
                return true;
            }
            memos[uid] = false;
            return false;
        case POSITIVE_LOOK_AHEAD:
        case NEGATIVE_LOOK_AHEAD:
            var position = context.position,
                result = evaluate(context, null, rules, rule[1]) === (type === POSITIVE_LOOK_AHEAD);
            context.position = position;
            memos[uid] = result;

            return result;

        case ZERO_OR_MORE:
            var child,
                position = context.position,
                childCount = parent && parent.children.length;

            while (evaluate(context, parent, rules, rule[1]))
            {
                position = context.position,
                childCount = parent && parent.children.length;
            }

            context.position = position;
            if (parent)
                parent.children.length = childCount;

            return true;

        case ONE_OR_MORE:
            var position = context.position,
                childCount = parent && parent.children.length;
            if (!evaluate(context, parent, rules, rule[1]))
            {
                memos[uid] = false;
                context.position = position;
                if (parent)
                    parent.children.length = childCount;
                return false;
            }
            position = context.position,
            childCount = parent && parent.children.length;
            while (evaluate(context, parent, rules, rule[1]))
            {
                position = context.position;
                childCount = parent && parent.children.length;
            }
            context.position = position;
            if (parent)
                parent.children.length = childCount;
            return true;

        case OPTIONAL:
            var position = context.position,
                childCount = parent && parent.children.length;

            if (!evaluate(context, parent, rules, rule[1]))
            {
                context.position = position;

                if (parent)
                    parent.children.length = childCount;
            }

            return true;
    }
}

function SyntaxNode(/*String*/ aName, /*String*/ aSource, /*Number*/ aLocation, /*Number*/ aLength, /*String*/anErrorMessage)
{
    this.name = aName;
    this.source = aSource;
    this.range = { location:aLocation, length:aLength };
    this.children = [];

    if (anErrorMessage)
        this.error = anErrorMessage;
}

SyntaxNode.prototype.report = function()
{
    var source = this.source,
        lineNumber = 1,
        index = 0,
        start = 0,
        length = source.length,
        range = this.range;

    for (; index < range.location; ++index)
        if (source.charAt(index) === '\n')
        {
            ++lineNumber;
            start = index + 1;
        }

    for (; index < length; ++index)
        if (source.charAt(index) === '\n')
            break;

    var visualization = source.substring(start, index) + "\n";

    visualization += (new Array(this.range.location - start + 1)).join(" ");
    visualization += (new Array(Math.min(range.length, visualization.length) + 1)).join("^");

    return  {
                visualization: visualization,
                lineNumber: lineNumber
            };
}

SyntaxNode.prototype.message = function()
{
    var report = this.report(),
        message = report.visualization + "\n";

    message += "ERROR line " + report.lineNumber + ": " + this.error;

    return message;
}

SyntaxNode.prototype.toString = function(/*String*/ spaces)
{
    if (!spaces)
        spaces = "";

    var string = spaces + this.name +  " <" + this.innerText() + "> ",
        children = this.children,
        index = 0,
        count = children.length;

    for (; index < count; ++index)
    {
        var child = children[index];

        if (typeof child === "string")
            string += "\n" + spaces + "\t" + child;

        else
            string += "\n" + children[index].toString(spaces + '\t');
    }

    return string;
}

SyntaxNode.prototype.innerText = function()
{
    var range = this.range;

    return this.source.substr(range.location, range.length);
}

SyntaxNode.prototype.traverse = function(walker)
{
    if (!walker.enteredNode || walker.enteredNode(this) !== false)
    {
        var children = this.children,
            index = 0,
            count = children && children.length;

        for (; index < count; ++index)
        {
            var child = children[index];

            if (typeof child !== "string")
                child.traverse(walker);

            else if (walker.traversesTextNodes)
            {
                walker.enteredNode(child);

                if (walker.exitedNode)
                    walker.exitedNode(child);
            }
        }
    }

    if (walker.exitedNode)
        walker.exitedNode(this);
}


if (typeof system !== "undefined")
{
    var parser = new Parser(compiledGrammar);

    exports.parse = function(input) { return parser.parse(input); }
}
else
    module.exports = new Parser(compiledGrammar);

